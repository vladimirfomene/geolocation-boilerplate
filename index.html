<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <title>Find My Location - VladimirFomene</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="css/materialize.min.css">

  <style>
    html, body {
      height: 100%;
      margin: 0;
    }

    #map{
      height: 100%;
    }

    #location-btn{
      position: fixed;
      bottom: 0;
      right: 0;
      width: 100%;
    }
  </style>

  <script>
    var userAgent = navigator.userAgent + '';
    if (userAgent.indexOf('iPhone') > -1) {
      document.write('<script src="js/lib/cordova-iphone.js"></sc' + 'ript>');
      var mobile_system = 'iphone';
    } else if (userAgent.indexOf('Android') > -1) {
      document.write('<script src="js/lib/cordova-android.js"></sc' + 'ript>');
      var mobile_system = 'android';
    } else {
      var mobile_system = '';
    }


    //Google map initialization
    var map = null;
    var marker = null;
    function initMap(){

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position){

          var mapOptions = {
            center: new google.maps.LatLng(position.coords.latitude,position.coords.longitude),
            zoom: 12,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          };

          map = new google.maps.Map(document.getElementById('map'), mapOptions);


        });
      } else {
        alert("There is no location support on your browser.");
      }

    }

    window.onload = function(){
      document.getElementById("location-btn").addEventListener("click", function(){
        if(navigator.geolocation){
          navigator.geolocation.getCurrentPosition(function(position){

            if(marker === null){

              var markerOptions = {
                position: new google.maps.LatLng(position.coords.latitude, position.coords.longitude)
              };

              marker = new google.maps.Marker(markerOptions);

              marker.setMap(map);
            }else{
              marker.setMap(null);
              marker = null;
            }
          });


        }else{
          alert("There is no location support on your browser")
        }
      });

    };

  </script>

  </head>
  <body>
     <nav>
       <div class="nav-wrapper">
         <a href="#" class="brand-logo center">Find Me</a>
       </div>
    </nav>
    <div id="map">
    </div>
    <a class="waves-effect waves-light btn" id="location-btn">Pin Location</a>
    <!-- Google maps javascript api -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDi5XLlJPvGIvOx3lia08f307ahecCQhXM&callback=initMap"
    async defer></script>

    <!-- Compiled and minified JavaScript -->
    <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    <script src="js/materialize.min.js"></script>

  </body>
</html>
